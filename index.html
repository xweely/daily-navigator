<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Navigator</title>
    <style>
        body { 
            margin: 0; 
            background: rgba(144, 238, 144, 0.7); /* LightGreen with 70% opacity */
            color: #000; 
            font-family: sans-serif; 
            height: 100vh; 
            display: flex; 
            flex-direction: column;
            user-select: none; 
            overflow: hidden;
        }

        /* Top container for Date and Time in one row */
        #top-container {
            margin-top: 20px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 15px;
            pointer-events: none;
            font-weight: bold;
            opacity: 0.3; 
        }
        #date-display, #time-display { font-size: 0.9rem; }

        /* Content section - 25% higher than center */
        #content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding-bottom: 25vh; 
        }
        #step-info { font-size: 1.4rem; font-weight: bold; opacity: 0.25; text-transform: uppercase; min-height: 1.5rem; }
        #task { font-size: 4.5rem; font-weight: 900; margin: 10px 20px; line-height: 1.1; letter-spacing: -1.5px; }
    </style>
</head>
<body onclick="nextStep()">

    <div id="top-container">
        <div id="date-display">0000-00-00 (-)</div>
        <div id="time-display">00:00 AM</div>
    </div>

    <div id="content">
        <div id="step-info">Step 1</div>
        <div id="task">Loading...</div>
    </div>

    <script>
        const routines = [
            { start: "00:00", end: "12:00", steps: ["Drink warm water", "Take Duspatalin", "Milk, chia seed mixture", "Toilet", "Exercise"] },
            { start: "13:00", end: "14:30", steps: ["Take Visanne", "Multivitamins"] },
            { start: "15:30", end: "16:40", steps: ["Drink milk"] },
            { start: "16:41", end: "17:30", steps: ["Drink water", "Lie Down Exercise", "Left leg bend", "Child's pose", "Cat's stretch"] },
            { start: "17:31", end: "18:14", steps: ["Back exercise", "Walk in park"] },
            { start: "18:15", end: "19:00", steps: ["Drink water", "Take Duspatalin"] },
            { start: "19:30", end: "20:30", steps: ["Drink Apple cider water"] },
            { start: "20:31", end: "21:20", steps: ["Bath, cook water"] },
            { start: "21:21", end: "22:00", steps: ["Eat a bit"] },
            { start: "22:01", end: "23:30", steps: ["Probiotics", "Brush teeth ðŸª¥", "On bed"] }
        ];
        
        const standardRecovery = ["Drink water", "Neck exercise", "Breathe ðŸ’"];
        let mainSteps = [];
        let recoverySteps = [];
        let index = 0;

        function updateDateTime() {
            const now = new Date();
            const days = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
            document.getElementById('date-display').innerText = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} (${days[now.getDay()]})`;

            let hours = now.getHours();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12;
            document.getElementById('time-display').innerText = `${hours}:${String(now.getMinutes()).padStart(2, '0')} ${ampm}`;
        }

        function init() {
            updateDateTime();
            const now = new Date();
            const currentTime = String(now.getHours()).padStart(2, '0') + ":" + String(now.getMinutes()).padStart(2, '0');
            const found = routines.find(r => currentTime >= r.start && currentTime <= r.end);
            
            if (found) {
                mainSteps = [...found.steps];
                recoverySteps = (found.start === "00:00") ? [] : standardRecovery.filter(s => !mainSteps.includes(s));
            } else {
                mainSteps = ["Drink water", "Neck exercise"];
                recoverySteps = ["Breathe"];
            }
            index = 0;
            render();
        }

        function render() {
            const totalMain = mainSteps.length;
            const currentTask = document.getElementById('task');
            const currentInfo = document.getElementById('step-info');

            if (index < totalMain) {
                currentInfo.innerText = `Step ${index + 1} of ${totalMain}`;
                currentTask.innerText = mainSteps[index];
            } else if (index < (totalMain + recoverySteps.length)) {
                currentInfo.innerText = ""; 
                currentTask.innerText = recoverySteps[index - totalMain];
            }
        }

        function nextStep() {
            if (index < (mainSteps.length + recoverySteps.length - 1)) { 
                index++; 
                render(); 
                if (navigator.vibrate) navigator.vibrate(50); 
            } else { 
                // Loop back to start immediately instead of showing "Rest"
                index = 0; 
                init(); 
            }
        }

        setInterval(updateDateTime, 10000);
        init();
    </script>
</body>
</html>
